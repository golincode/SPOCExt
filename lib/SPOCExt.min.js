!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("SPOCExt",[],t):"object"==typeof exports?exports.SPOCExt=t():e.SPOCExt=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1),a=r(i),s=n(15),l=r(s),c=n(16),f=r(c),d=n(17),p=r(d),v=n(18),h=r(v),y=n(19),m=r(y),_=n(2),g=r(_),w=n(6),b=r(w),T=function(){function e(){o(this,e),this._name="SPOC",window.Promise=window.Promise?window.Promise:b["default"].Promise}return u(e,[{key:"name",get:function(){return this._name}}]),e}();T.SP=function(){function e(){o(this,e),this._name="SP"}return u(e,[{key:"name",get:function(){return this._name}}]),e}(),T.SP.Site=function(){function e(t){o(this,e),this.url=t?t:window._spPageContextInfo.webAbsoluteUrl,this.ListItems=a["default"],this.Delve=l["default"],this.Files=f["default"],this.Lists=p["default"],this.Search=h["default"]}return e}(),T.SP.User=function(){function e(t){o(this,e),this.id=t?t:window._spPageContextInfo.userId,this.loginName=t?t:window._spPageContextInfo.userLoginName,this.Profile=m["default"]}return e}(),T.Utils=function(){function e(){o(this,e),this._name="Utils"}return u(e,[{key:"name",get:function(){return this._name}}]),e}(),T.Utils=g["default"],t["default"]=T,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){var t=this,n={};return n.query=function(n,r,o){var u=t.url+"/_api/web/lists/getByTitle%28%27"+e+"%27%29/items";return u+=n?"?"+i["default"].Conversion.objToQueryString(n):"",i["default"].Request.get(u,r)},n.queryCSOM=function(n){return new s["default"].Promise(function(r,o){var u,i=new SP.ClientContext(t.url),a=i.get_web().get_lists().getByTitle(e);n?(u=new SP.CamlQuery,u.set_viewXml(n)):u=SP.CamlQuery.createAllItemsQuery();var s=a.getItems(u);i.load(s),i.executeQueryAsync(function(){var e=s.get_data().map(function(e){return e.get_fieldValues()});r(e)},function(e){o(e)})})},n.create=function(n,r){var o=t.url+"/_api/web/lists/getByTitle%28%27"+e+"%27%29/items",u={__metadata:{type:i["default"].SP.getListItemType(e,r)}};return n&&(u=i["default"].Objects.merge(u,n)),i["default"].Request.post(o,u)},n.update=function(n,r,o){var u=t.url+"/_api/web/lists/getByTitle%28%27"+e+"%27%29/items("+n+")",a={__metadata:{type:i["default"].SP.getListItemType(e,o)}};return r&&(a=i["default"].Objects.merge(a,r)),i["default"].Request.put(u,a)},n["delete"]=function(n,r){var o=t.url+"/_api/web/lists/getByTitle%28%27"+e+"%27%29/items("+n+")",u={__metadata:{type:i["default"].SP.getListItemType(e,r)}};return i["default"].Request["delete"](o,u)},n}Object.defineProperty(t,"__esModule",{value:!0});var u=n(2),i=r(u),a=n(6),s=r(a);t["default"]=o,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(3),a=r(i),s=n(4),l=r(s),c=n(5),f=r(c),d=n(10),p=r(d),v=n(11),h=r(v),y=n(12),m=r(y),_=n(13),g=r(_),w=n(14),b=r(w),T=function(){function e(){o(this,e),this._name="Utils"}return u(e,[{key:"name",get:function(){return this._name}}]),e}();T.Conversion=a["default"],T.Request=f["default"],T.SP=l["default"],T.Objects=p["default"],T.Storage=h["default"],T.Strings=m["default"],T.Tpl=g["default"],T.Url=b["default"],t["default"]=T,e.exports=t["default"]},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){n(this,e)}return r(e,null,[{key:"objToQueryString",value:function(e){var t="";for(var n in e)t+="&$"+n+"="+e[n];return t}},{key:"spInternalName",value:function(e){return e.replace(/ /g,"_x0020_")}}]),e}();t["default"]=o,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2),a=r(i),s=function(){function e(){o(this,e)}return u(e,null,[{key:"getListItemType",value:function(e,t){var n=t?"Item":"ListItem";return e=e[0].toUpperCase()+e.substring(1),"SP.Data."+e.replace(/ /g,"_x0020_")+n}},{key:"isAppWeb",value:function(){return window.location.href.toLowerCase().indexOf("sphosturl")>-1}},{key:"convertToWebApp",value:function(e){if(e.toLowerCase().indexOf("WopiFrame.aspx")>-1)return e;var t=a["default"].Strings.getFileExtension(e);return"docx"===t||"pptx"===t||"xlsx"===t?window._spPageContextInfo.webAbsoluteUrl+"/_layouts/15/WopiFrame.aspx?sourcedoc="+e:e}},{key:"formatSearchResponse",value:function(e){var t,n,r,o,u=e.query.PrimaryQueryResult.RelevantResults.Table.Rows,i=[];for(u=u.results||[u],r=0;r<u.length;r++){for(t=u[r].Cells.results,n={},o=0;o<t.length;o++)n[t[o].Key]=t[o].Value;i.push(n)}return i}}]),e}();t["default"]=s,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2),a=r(i),s=n(6),l=r(s),c=function(){function e(){o(this,e)}return u(e,null,[{key:"get",value:function(e,t){return new l["default"].Promise(function(n,r){var o=a["default"].Storage.get("SPOC-"+e);if(o&&t)n(o);else if(!a["default"].Url.isSameDomain(e)&&e.toLowerCase().indexOf("_api/web")>-1){e=a["default"].Url.convertToXDomain(e);var u=a["default"].Url.AppWebUrl(),i=a["default"].Url.HostWebUrl();this.Request.loadRequestor(i+"/_layouts/15/SP.RequestExecutor.js").then(function(){var t=new SP.RequestExecutor(u);t.executeAsync({url:e,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(e){n(e)},error:function(e){r(e)}})})}else{var s=new XMLHttpRequest;s.open("GET",e,!0),s.setRequestHeader("Accept","application/json;odata=verbose"),s.onreadystatechange=function(){if(4===s.readyState)if(200===s.status){var t=JSON.parse(s.responseText);t=t.d.results?t.d.results:t.d,a["default"].Storage.set("SPOC-"+e,t),n(t)}else r(s)},s.onerror=function(e){r(Error("Network Error"))},s.send()}})}},{key:"post",value:function(e,t,n){return new l["default"].Promise(function(r,o){if(!a["default"].Url.isSameDomain(e)&&e.toLowerCase().indexOf("_api/web")>-1){e=a["default"].Url.convertToXDomain(e);var u=a["default"].Url.AppWebUrl(),i=a["default"].Url.HostWebUrl();this.Request.loadRequestor(i+"/_layouts/15/SP.RequestExecutor.js").then(function(){var i=new SP.RequestExecutor(u),a={Accept:"application/json; odata=verbose","X-RequestDigest":document.getElementById("__REQUESTDIGEST").value,"Content-Type":"application/json;odata=verbose"};n&&(a["Content-Type"]=t.byteLength),i.executeAsync({url:e,method:"POST",body:JSON.stringify(t),headers:a,success:function(e){r(e)},error:function(e){o(e)}})})}else{var s=new XMLHttpRequest;s.open("POST",e,!0),s.setRequestHeader("Accept","application/json;odata=verbose"),s.setRequestHeader("X-RequestDigest",document.getElementById("__REQUESTDIGEST").value),s.setRequestHeader("Content-Type","application/json;odata=verbose"),s.onreadystatechange=function(){4===s.readyState&&(200===s.status||201===s.status||1223===s.status?r(t):o(s))},s.onerror=function(e){o(Error("Network Error"))},s.send(n?t:JSON.stringify(t))}})}},{key:"put",value:function(e,t){return new l["default"].Promise(function(n,r){if(!a["default"].Url.isSameDomain(e)&&e.toLowerCase().indexOf("_api/web")>-1){e=a["default"].Url.convertToXDomain(e);var o=a["default"].Url.AppWebUrl(),u=a["default"].Url.HostWebUrl();this.Request.loadRequestor(u+"/_layouts/15/SP.RequestExecutor.js").then(function(){var u=new SP.RequestExecutor(o),i={Accept:"application/json; odata=verbose","X-RequestDigest":document.getElementById("__REQUESTDIGEST").value,"Content-Type":"application/json;odata=verbose","X-HTTP-Method":"MERGE","If-Match":"*"};u.executeAsync({url:e,method:"POST",body:JSON.stringify(t),headers:i,success:function(e){n(e)},error:function(e){r(e)}})})}else{var i=new XMLHttpRequest;i.open("POST",e,!0),i.setRequestHeader("Accept","application/json;odata=verbose"),i.setRequestHeader("X-RequestDigest",document.getElementById("__REQUESTDIGEST").value),i.setRequestHeader("Content-Type","application/json;odata=verbose"),i.setRequestHeader("X-HTTP-Method","MERGE"),i.setRequestHeader("If-Match","*"),i.onreadystatechange=function(){4===i.readyState&&(200===i.status||204===i.status||1223===i.status?n(t):r(i))},i.onerror=function(e){r(Error("Network Error"))},i.send(JSON.stringify(t))}})}},{key:"delete",value:function(e,t){return new l["default"].Promise(function(n,r){if(!a["default"].Url.isSameDomain(e)&&e.toLowerCase().indexOf("_api/web")>-1){e=a["default"].Url.convertToXDomain(e);var o=a["default"].Url.AppWebUrl(),u=a["default"].Url.HostWebUrl();this.Request.loadRequestor(u+"/_layouts/15/SP.RequestExecutor.js").then(function(){var u=new SP.RequestExecutor(o),i={Accept:"application/json; odata=verbose","X-RequestDigest":document.getElementById("__REQUESTDIGEST").value,"Content-Type":"application/json;odata=verbose","X-HTTP-Method":"DELETE","If-Match":"*"};u.executeAsync({url:e,method:"POST",body:JSON.stringify(t),headers:i,success:function(e){n(e)},error:function(e){r(e)}})})}else{var i=new XMLHttpRequest;i.open("POST",e,!0),i.setRequestHeader("X-RequestDigest",document.getElementById("__REQUESTDIGEST").value),i.setRequestHeader("X-HTTP-Method","DELETE"),i.setRequestHeader("If-Match","*"),i.onreadystatechange=function(){4===i.readyState&&(200===i.status||204===i.status||1223===i.status?n(t):r(i))},i.onerror=function(e){r(Error("Network Error"))},i.send(JSON.stringify(t))}})}},{key:"loadRequestor",value:function(e){return new l["default"].Promise(function(t,n){var r=document.createElement("script");r.src=e,r.addEventListener("load",function(){t(e)},!1),r.addEventListener("error",function(){n(e)},!1),SP.RequestExecutor?t(e):document.body.appendChild(r)})}}]),e}();t["default"]=c,e.exports=t["default"]},function(e,t,n){(function(e,r,o){/*!
	 * @overview RSVP - a tiny implementation of Promises/A+.
	 * @copyright Copyright (c) 2016 Yehuda Katz, Tom Dale, Stefan Penner and contributors
	 * @license   Licensed under MIT license
	 *            See https://raw.githubusercontent.com/tildeio/rsvp.js/master/LICENSE
	 * @version   3.3.3
	 */
!function(e,n){n(t)}(this,function(t){"use strict";function u(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}function i(e){var t=e._promiseCallbacks;return t||(t=e._promiseCallbacks={}),t}function a(e,t){return"onerror"===e?void Ee.on("error",t):2!==arguments.length?Ee[e]:void(Ee[e]=t)}function s(e){return"function"==typeof e||"object"==typeof e&&null!==e}function l(e){return"function"==typeof e}function c(e){return"object"==typeof e&&null!==e}function f(){}function d(){setTimeout(function(){for(var e=0;e<ke.length;e++){var t=ke[e],n=t.payload;n.guid=n.key+n.id,n.childGuid=n.key+n.childId,n.error&&(n.stack=n.error.stack),Ee.trigger(t.name,t.payload)}ke.length=0},50)}function p(e,t,n){1===ke.push({name:e,payload:{key:t._guidKey,id:t._id,eventName:e,detail:t._result,childId:n&&n._id,label:t._label,timeStamp:je(),error:Ee["instrument-with-stack"]?new Error(t._label):null}})&&d()}function v(e,t){var n=this;if(e&&"object"==typeof e&&e.constructor===n)return e;var r=new n(y,t);return T(r,e),r}function h(){return new TypeError("A promises callback cannot return that same promise.")}function y(){}function m(e){try{return e.then}catch(t){return qe.error=t,qe}}function _(e,t,n,r){try{e.call(t,n,r)}catch(o){return o}}function g(e,t,n){Ee.async(function(e){var r=!1,o=_(n,t,function(n){r||(r=!0,t!==n?T(e,n,void 0):P(e,n))},function(t){r||(r=!0,E(e,t))},"Settle: "+(e._label||" unknown promise"));!r&&o&&(r=!0,E(e,o))},e)}function w(e,t){t._state===Ae?P(e,t._result):t._state===Ie?(t._onError=null,E(e,t._result)):R(t,void 0,function(n){t!==n?T(e,n,void 0):P(e,n)},function(t){return E(e,t)})}function b(e,t,n){t.constructor===e.constructor&&n===A&&e.constructor.resolve===v?w(e,t):n===qe?E(e,qe.error):void 0===n?P(e,t):l(n)?g(e,t,n):P(e,t)}function T(e,t){e===t?P(e,t):s(t)?b(e,t,m(t)):P(e,t)}function S(e){e._onError&&e._onError(e._result),x(e)}function P(e,t){e._state===Ce&&(e._result=t,e._state=Ae,0===e._subscribers.length?Ee.instrument&&p("fulfilled",e):Ee.async(x,e))}function E(e,t){e._state===Ce&&(e._state=Ie,e._result=t,Ee.async(S,e))}function R(e,t,n,r){var o=e._subscribers,u=o.length;e._onError=null,o[u]=t,o[u+Ae]=n,o[u+Ie]=r,0===u&&e._state&&Ee.async(x,e)}function x(e){var t=e._subscribers,n=e._state;if(Ee.instrument&&p(n===Ae?"fulfilled":"rejected",e),0!==t.length){for(var r=void 0,o=void 0,u=e._result,i=0;i<t.length;i+=3)r=t[i],o=t[i+n],r?k(n,r,o,u):o(u);e._subscribers.length=0}}function j(){this.error=null}function O(e,t){try{return e(t)}catch(n){return Me.error=n,Me}}function k(e,t,n,r){var o=l(n),u=void 0,i=void 0,a=void 0,s=void 0;if(o){if(u=O(n,r),u===Me?(s=!0,i=u.error,u=null):a=!0,t===u)return void E(t,h())}else u=r,a=!0;t._state!==Ce||(o&&a?T(t,u):s?E(t,i):e===Ae?P(t,u):e===Ie&&E(t,u))}function C(e,t){var n=!1;try{t(function(t){n||(n=!0,T(e,t))},function(t){n||(n=!0,E(e,t))})}catch(r){E(e,r)}}function A(e,t,n){var r=arguments,o=this,u=o._state;if(u===Ae&&!e||u===Ie&&!t)return Ee.instrument&&p("chained",o,o),o;o._onError=null;var i=new o.constructor(y,n),a=o._result;return Ee.instrument&&p("chained",o,i),u?!function(){var e=r[u-1];Ee.async(function(){return k(u,i,e,a)})}():R(o,i,e,t),i}function I(e,t,n){return e===Ae?{state:"fulfilled",value:n}:{state:"rejected",reason:n}}function q(e,t,n,r){this._instanceConstructor=e,this.promise=new e(y,r),this._abortOnReject=n,this._validateInput(t)?(this._input=t,this.length=t.length,this._remaining=t.length,this._init(),0===this.length?P(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&P(this.promise,this._result))):E(this.promise,this._validationError())}function M(e,t){return new q(this,e,(!0),t).promise}function U(e,t){var n=this,r=new n(y,t);if(!xe(e))return E(r,new TypeError("You must pass an array to race.")),r;for(var o=0;r._state===Ce&&o<e.length;o++)R(n.resolve(e[o]),void 0,function(e){return T(r,e)},function(e){return E(r,e)});return r}function L(e,t){var n=this,r=new n(y,t);return E(r,e),r}function D(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function N(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function H(e,t){this._id=Le++,this._label=t,this._state=void 0,this._result=void 0,this._subscribers=[],Ee.instrument&&p("created",this),y!==e&&("function"!=typeof e&&D(),this instanceof H?C(this,e):N())}function Q(){this.value=void 0}function W(e){try{return e.then}catch(t){return De.value=t,De}}function B(e,t,n){try{e.apply(t,n)}catch(r){return De.value=r,De}}function G(e,t){for(var n={},r=e.length,o=new Array(r),u=0;u<r;u++)o[u]=e[u];for(var i=0;i<t.length;i++){var a=t[i];n[a]=o[i+1]}return n}function X(e){for(var t=e.length,n=new Array(t-1),r=1;r<t;r++)n[r-1]=e[r];return n}function F(e,t){return{then:function(n,r){return e.call(t,n,r)}}}function J(e,t){var n=function(){for(var n=this,r=arguments.length,o=new Array(r+1),u=!1,i=0;i<r;++i){var a=arguments[i];if(!u){if(u=V(a),u===Ne){var s=new H(y);return E(s,Ne.value),s}u&&u!==!0&&(a=F(u,a))}o[i]=a}var l=new H(y);return o[r]=function(e,n){e?E(l,e):void 0===t?T(l,n):t===!0?T(l,X(arguments)):xe(t)?T(l,G(arguments,t)):T(l,n)},u?K(l,o,e,n):$(l,o,e,n)};return n.__proto__=e,n}function $(e,t,n,r){var o=B(n,r,t);return o===De&&E(e,o.value),e}function K(e,t,n,r){return H.all(t).then(function(t){var o=B(n,r,t);return o===De&&E(e,o.value),e})}function V(e){return!(!e||"object"!=typeof e)&&(e.constructor===H||W(e))}function Y(e,t){return H.all(e,t)}function z(e,t,n){this._superConstructor(e,t,!1,n)}function Z(e,t){return new z(H,e,t).promise}function ee(e,t){return H.race(e,t)}function te(e,t,n){this._superConstructor(e,t,!0,n)}function ne(e,t){return new te(H,e,t).promise}function re(e,t,n){this._superConstructor(e,t,!1,n)}function oe(e,t){return new re(H,e,t).promise}function ue(e){throw setTimeout(function(){throw e}),e}function ie(e){var t={resolve:void 0,reject:void 0};return t.promise=new H(function(e,n){t.resolve=e,t.reject=n},e),t}function ae(e,t,n){return H.all(e,n).then(function(e){if(!l(t))throw new TypeError("You must pass a function as map's second argument.");for(var r=e.length,o=new Array(r),u=0;u<r;u++)o[u]=t(e[u]);return H.all(o,n)})}function se(e,t){return H.resolve(e,t)}function le(e,t){return H.reject(e,t)}function ce(e,t){return H.all(e,t)}function fe(e,t){return H.resolve(e,t).then(function(e){return ce(e,t)})}function de(e,t,n){var r=xe(e)?ce(e,n):fe(e,n);return r.then(function(e){if(!l(t))throw new TypeError("You must pass a function as filter's second argument.");for(var r=e.length,o=new Array(r),u=0;u<r;u++)o[u]=t(e[u]);return ce(o,n).then(function(t){for(var n=new Array(r),o=0,u=0;u<r;u++)t[u]&&(n[o]=e[u],o++);return n.length=o,n})})}function pe(e,t){Je[He]=e,Je[He+1]=t,He+=2,2===He&&$e()}function ve(){var t=e.nextTick,n=e.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(n)&&"0"===n[1]&&"10"===n[2]&&(t=r),function(){return t(ge)}}function he(){return"undefined"!=typeof Qe?function(){Qe(ge)}:_e()}function ye(){var e=0,t=new Ge(ge),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){return n.data=e=++e%2}}function me(){var e=new MessageChannel;return e.port1.onmessage=ge,function(){return e.port2.postMessage(0)}}function _e(){return function(){return setTimeout(ge,1)}}function ge(){for(var e=0;e<He;e+=2){var t=Je[e],n=Je[e+1];t(n),Je[e]=void 0,Je[e+1]=void 0}He=0}function we(){try{var e=n(9);return Qe=e.runOnLoop||e.runOnContext,he()}catch(t){return _e()}}function be(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Te(){Ee.on.apply(Ee,arguments)}function Se(){Ee.off.apply(Ee,arguments)}var Pe={mixin:function(e){return e.on=this.on,e.off=this.off,e.trigger=this.trigger,e._promiseCallbacks=void 0,e},on:function(e,t){if("function"!=typeof t)throw new TypeError("Callback must be a function");var n=i(this),r=void 0;r=n[e],r||(r=n[e]=[]),u(r,t)===-1&&r.push(t)},off:function(e,t){var n=i(this),r=void 0,o=void 0;return t?(r=n[e],o=u(r,t),void(o!==-1&&r.splice(o,1))):void(n[e]=[])},trigger:function(e,t,n){var r=i(this),o=void 0,u=void 0;if(o=r[e])for(var a=0;a<o.length;a++)(u=o[a])(t,n)}},Ee={instrument:!1};Pe.mixin(Ee);var Re=void 0;Re=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var xe=Re,je=Date.now||function(){return(new Date).getTime()},Oe=Object.create||function(e){if(arguments.length>1)throw new Error("Second argument not supported");if("object"!=typeof e)throw new TypeError("Argument must be an object");return f.prototype=e,new f},ke=[],Ce=void 0,Ae=1,Ie=2,qe=new j,Me=new j;q.prototype._validateInput=function(e){return xe(e)},q.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},q.prototype._init=function(){this._result=new Array(this.length)},q.prototype._enumerate=function(){for(var e=this.length,t=this.promise,n=this._input,r=0;t._state===Ce&&r<e;r++)this._eachEntry(n[r],r)},q.prototype._settleMaybeThenable=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===v){var o=m(e);if(o===A&&e._state!==Ce)e._onError=null,this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=this._makeResult(Ae,t,e);else if(n===H){var u=new n(y);b(u,e,o),this._willSettleAt(u,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},q.prototype._eachEntry=function(e,t){c(e)?this._settleMaybeThenable(e,t):(this._remaining--,this._result[t]=this._makeResult(Ae,t,e))},q.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===Ce&&(this._remaining--,this._abortOnReject&&e===Ie?E(r,n):this._result[t]=this._makeResult(e,t,n)),0===this._remaining&&P(r,this._result)},q.prototype._makeResult=function(e,t,n){return n},q.prototype._willSettleAt=function(e,t){var n=this;R(e,void 0,function(e){return n._settledAt(Ae,t,e)},function(e){return n._settledAt(Ie,t,e)})};var Ue="rsvp_"+je()+"-",Le=0;H.cast=v,H.all=M,H.race=U,H.resolve=v,H.reject=L,H.prototype={constructor:H,_guidKey:Ue,_onError:function(e){var t=this;Ee.after(function(){t._onError&&Ee.trigger("error",e,t._label)})},then:A,"catch":function(e,t){return this.then(void 0,e,t)},"finally":function(e,t){var n=this,r=n.constructor;return n.then(function(t){return r.resolve(e()).then(function(){return t})},function(t){return r.resolve(e()).then(function(){throw t})},t)}};var De=new Q,Ne=new Q;z.prototype=Oe(q.prototype),z.prototype._superConstructor=q,z.prototype._makeResult=I,z.prototype._validationError=function(){return new Error("allSettled must be called with an array")},te.prototype=Oe(q.prototype),te.prototype._superConstructor=q,te.prototype._init=function(){this._result={}},te.prototype._validateInput=function(e){return e&&"object"==typeof e},te.prototype._validationError=function(){return new Error("Promise.hash must be called with an object")},te.prototype._enumerate=function(){var e=this,t=e.promise,n=e._input,r=[];for(var o in n)t._state===Ce&&Object.prototype.hasOwnProperty.call(n,o)&&r.push({position:o,entry:n[o]});var u=r.length;e._remaining=u;for(var i=void 0,a=0;t._state===Ce&&a<u;a++)i=r[a],e._eachEntry(i.entry,i.position)},re.prototype=Oe(te.prototype),re.prototype._superConstructor=q,re.prototype._makeResult=I,re.prototype._validationError=function(){return new Error("hashSettled must be called with an object")};var He=0,Qe=void 0,We="undefined"!=typeof window?window:void 0,Be=We||{},Ge=Be.MutationObserver||Be.WebKitMutationObserver,Xe="undefined"==typeof self&&"undefined"!=typeof e&&"[object process]"==={}.toString.call(e),Fe="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,Je=new Array(1e3),$e=void 0;$e=Xe?ve():Ge?ye():Fe?me():void 0===We?we():_e();var Ke=void 0;if("object"==typeof self)Ke=self;else{if("object"!=typeof o)throw new Error("no global: `self` or `global` found");Ke=o}var Ve;Ee.async=pe,Ee.after=function(e){return setTimeout(e,0)};var Ye=se,ze=function(e,t){return Ee.async(e,t)};if("undefined"!=typeof window&&"object"==typeof window.__PROMISE_INSTRUMENTATION__){var Ze=window.__PROMISE_INSTRUMENTATION__;a("instrument",!0);for(var et in Ze)Ze.hasOwnProperty(et)&&Te(et,Ze[et])}var tt=(Ve={cast:Ye,Promise:H,EventTarget:Pe,all:Y,allSettled:Z,race:ee,hash:ne,hashSettled:oe,rethrow:ue,defer:ie,denodeify:J,configure:a,on:Te,off:Se,resolve:se,reject:le,map:ae},be(Ve,"async",ze),be(Ve,"filter",de),Ve);t["default"]=tt,t.cast=Ye,t.Promise=H,t.EventTarget=Pe,t.all=Y,t.allSettled=Z,t.race=ee,t.hash=ne,t.hashSettled=oe,t.rethrow=ue,t.defer=ie,t.denodeify=J,t.configure=a,t.on=Te,t.off=Se,t.resolve=se,t.reject=le,t.map=ae,t.async=ze,t.filter=de,Object.defineProperty(t,"__esModule",{value:!0})})}).call(t,n(7),n(8).setImmediate,function(){return this}())},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(e){if(c===setTimeout)return setTimeout(e,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function u(e){if(f===clearTimeout)return clearTimeout(e);if((f===r||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}function i(){h&&p&&(h=!1,p.length?v=p.concat(v):y=-1,v.length&&a())}function a(){if(!h){var e=o(i);h=!0;for(var t=v.length;t;){for(p=v,v=[];++y<t;)p&&p[y].run();y=-1,t=v.length}p=null,h=!1,u(e)}}function s(e,t){this.fun=e,this.array=t}function l(){}var c,f,d=e.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(e){c=n}try{f="function"==typeof clearTimeout?clearTimeout:r}catch(e){f=r}}();var p,v=[],h=!1,y=-1;d.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];v.push(new s(e,t)),1!==v.length||h||o(a)},s.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=l,d.addListener=l,d.once=l,d.off=l,d.removeListener=l,d.removeAllListeners=l,d.emit=l,d.binding=function(e){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(e){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},function(e,t,n){(function(e,r){function o(e,t){this._id=e,this._clearFn=t}var u=n(7).nextTick,i=Function.prototype.apply,a=Array.prototype.slice,s={},l=0;t.setTimeout=function(){return new o(i.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new o(i.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},t.setImmediate="function"==typeof e?e:function(e){var n=l++,r=!(arguments.length<2)&&a.call(arguments,1);return s[n]=!0,u(function(){s[n]&&(r?e.apply(null,r):e.call(null),t.clearImmediate(n))}),n},t.clearImmediate="function"==typeof r?r:function(e){delete s[e]}}).call(t,n(8).setImmediate,n(8).clearImmediate)},function(e,t){},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){n(this,e)}return r(e,null,[{key:"findObjectByProperty",value:function(e,t,n){for(var r=0;r<e.length;r++)if(e[r][t]===n)return e[r];return!1}},{key:"merge",value:function(e,t){for(var n in t)try{t[n].constructor===Object?e[n]=this.merge(e[n],t[n]):e[n]=t[n]}catch(r){e[n]=t[n]}return e}}]),e}();t["default"]=o,e.exports=t["default"]},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){n(this,e)}return r(e,null,[{key:"storageAvailable",value:function(){return"undefined"!=typeof e}},{key:"set",value:function(e,t,n){if(this.storageAvailable()){var r=n?localStorage:sessionStorage;r.setItem(e,t===Object(t)?JSON.stringify(t):t)}}},{key:"get",value:function(e,t){if(this.storageAvailable()){var n=t?localStorage:sessionStorage,r=n.getItem(e);return r?JSON.parse(r):null}return null}},{key:"remove",value:function(e,t){if(this.storageAvailable()){var n=t?localStorage:sessionStorage;n.removeItem(e)}}},{key:"getCookie",value:function(e){e+="=";for(var t=document.cookie.split(";"),n=0;n<t.length;n++){var r=t[n].trim();if(0===r.indexOf(e))return r.substring(e.length,r.length)}return!1}},{key:"setCookies",value:function(e,t,n){var r;if(n){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3),r="; expires="+o.toGMTString()}else r="";document.cookie=e+"="+t+"; "+r}},{key:"removeCookies",value:function(e){this.setCookies(e,"",-1)}}]),e}();t["default"]=o,e.exports=t["default"]},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){n(this,e)}return r(e,null,[{key:"cut",value:function(e,t){return e.length>t?e.substr(0,t-3)+"...":e}},{key:"getFileExtension",value:function(e){return e.split(".").pop()}}]),e}();t["default"]=o,e.exports=t["default"]},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){n(this,e)}return r(e,null,[{key:"getProperty",value:function(e,t){var n,r=e.split("."),o=r.length,u=t||this;for(n=0;n<o;n++)u=u[r[n]];return u}},{key:"render",value:function(e,t){var n=/{{(.*?)}}/g,r=e.match(n);if(r&&r.length)for(var o=0,u=r.length;o<u;o++)e=e.replace(new RegExp(r[o],"g"),this.getProperty(r[o].replace(/{{|}}/g,""),t));return e}}]),e}();t["default"]=o,e.exports=t["default"]},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(){function e(){n(this,e)}return r(e,null,[{key:"getQueryString",value:function(e,t){t=t?t=t.split("?")[1]:window.location.search.substring(1);for(var n=t.split("&"),r=0;r<n.length;r++){var o=n[r].split("=");if(o[0]===e)return unescape(o[1])}}},{key:"getListNameFromUrl",value:function(e){var t=/\%27(.*)\%27/g,n=t.exec(e);return n?n[1]:null}},{key:"AppWebUrl",value:function(e){return decodeURIComponent(this.getQueryString("SPAppWebUrl"))}},{key:"HostWebUrl",value:function(e){return decodeURIComponent(this.getQueryString("SPHostUrl"))}},{key:"isSameDomain",value:function(e){return window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")),e.toLowerCase().indexOf(window.location.origin.toLowerCase())>-1}},{key:"convertToXDomain",value:function(e){e=e.toLowerCase().replace("/_api/","/_api/SP.AppContextSite(@target)/");var t=e.split("/_api")[0],n=window.location.href.toLowerCase().split("/pages")[0];return e=e.split("/_api")[1],e+=e.indexOf("?")===-1?"?":"&",n+"/_api"+e+"@target=%27"+t+"%27"}}]),e}();t["default"]=o,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){var t=this,n={};return n.board=function(n,r,o){return new s["default"].Promise(function(u,a){var s,l;n||(n="*"),e?(s=t.url+"/_api/search/query?Querytext=%27WorkEmail:"+e+"%27&SelectProperties=%27UserName,DocId%27",i["default"].Request.get(s,o).then(function(e){e=i["default"].SP.formatSearchResponse(e),e.length?(e.length>1&&(e=e[0]),l=e.DocId,s=t.url+"/_api/search/query?Querytext='"+n+"'&amp;Properties='GraphQuery:ACTOR("+l+r?", "+r:")",i["default"].Request.get(s,o).then(function(e){e=i["default"].SP.formatSearchResponse(e),u(e)},function(e){a(e)})):u(null)},function(e){a(e)})):(s=t.url+"/_api/search/query?Querytext='"+n+"'&amp;Properties='GraphQuery:ACTOR(ME"+r?", "+r:")",i["default"].Request.get(s,o).then(function(e){e=i["default"].SP.formatSearchResponse(e),u(e)},function(e){a(e)}))})},n}Object.defineProperty(t,"__esModule",{value:!0});var u=n(2),i=r(u),a=n(6),s=r(a);t["default"]=o,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){var t=this,n={};return n.generateExternalLink=function(n){n=n?n:24;var r=t.url+"/_api/Web/GetFileByServerRelativeUrl('"+e+"')/GetPreAuthorizedAccessUrl("+n+")";return i["default"].Request.get(r,!0)},n.uploadViaModal=function(e){return new s["default"].Promise(function(n,r){var o={};o.url=t.url+"/_layouts/Upload.aspx?List="+e+"&IsDlg=1",o.dialogReturnValueCallback=Function.createDelegate(null,function(e,t){n(t)}),SP.UI.ModalDialog.showModalDialog(o)})},n.upload=function(n,r){return new s["default"].Promise(function(o,u){var a=new FileReader;a.onloadend=function(a){var s=n.value.split("\\"),l=s[s.length-1],c=t.url+"/_api/Web/GetFolderByServerRelativeUrl('"+e+"')/files/add(overwrite=true, url='"+l+"')"+(r?"?$"+r:"");i["default"].Request.post(c,a.target.result,!0).then(function(e){o(e)},function(e){u(e)})},a.onerror=function(e){u(e.target.error)},a.readAsArrayBuffer(n.files[0])})},n.uploadFile=function(n,r){return new s["default"].Promise(function(o,u){var a=new FileReader;a.onloadend=function(a){var s=n?n.name:"",l=t.url+"/_api/Web/GetFolderByServerRelativeUrl('"+e+"')/files/add(overwrite=true, url='"+s+"')"+(r?"?$"+r:"");i["default"].Request.post(l,a.target.result,!0).then(function(e){o(e)},function(e){u(e)})},a.onerror=function(e){u(e.target.error)},a.readAsArrayBuffer(n)})},n.query=function(n){var r=t.url+"/_api/web/getfilebyserverrelativeurl('"+e+"')/ListItemAllFields";return i["default"].Request.get(r,n)},n.download=function(){window.open("/_layouts/download.aspx?SourceUrl="+t.url+e)},n.openInWebApps=function(n){var r=t.url+e;n?window.open(i["default"].SP.convertToWebApp(r)):window.location.href=i["default"].SP.convertToWebApp(r)},n}Object.defineProperty(t,"__esModule",{value:!0});var u=n(2),i=r(u),a=n(6),s=r(a);t["default"]=o,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){var t=this,n={};return n.query=function(n,r){var o=t.url+"/_api/web/lists/getByTitle%28%27"+e+"%27%29/";return o+=n?"?"+i["default"].Conversion.objToQueryString(n):"",i["default"].Request.get(o,r)},n.create=function(e){var n={__metadata:{type:"SP.List"},BaseTemplate:100,Description:""};return e&&(n=i["default"].Objects.merge(n,e)),i["default"].Request.post(t.url+"/_api/web/lists",n)},n.update=function(n){var r=t.url+"/_api/web/lists/getByTitle%28%27"+e+"%27%29",o={__metadata:{type:i["default"].SP.getListItemType(e)}};return n&&(o=i["default"].Objects.merge(o,n)),i["default"].Request.put(r,o)},n["delete"]=function(){var n=t.url+"/_api/web/lists/getByTitle%28%27"+e+"%27%29",r={__metadata:{type:i["default"].SP.getListItemType(e)}};return i["default"].Request["delete"](n,r)},n}Object.defineProperty(t,"__esModule",{value:!0});var u=n(2),i=r(u);t["default"]=o,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){var t=this,n={};return n.query=function(n,r){return new s["default"].Promise(function(o,u){var a=t.url+"/_api/search/query?querytext=%27"+e+" +path:"+t.url+"%27";a+=n?"?"+i["default"].Conversion.objToQueryString(n):"",i["default"].Request.get(a,r).then(function(e){e=i["default"].SP.formatSearchResponse(e),o(e)},function(e){u(e)})})},n}Object.defineProperty(t,"__esModule",{value:!0});var u=n(2),i=r(u),a=n(6),s=r(a);t["default"]=o,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(){var e=this,t={},n="i:0%23.f|membership|";return t.query=function(t){var r=window._spPageContextInfo.webAbsoluteUrl;return r+=e.loginName?"/_api/SP.UserProfiles.PeopleManager/GetPropertiesFor(accountName=@v)?@v=%27"+n+e.loginName+"%27":"/_api/SP.UserProfiles.PeopleManager/GetMyProperties/UserProfileProperties",i["default"].Request.get(r,t)},t.isMemberOfGroup=function(e,t,n,r){var o=n?n:window._spPageContextInfo.userId,u=e.url+"/_api/web/sitegroups/getByName('"+t+"')/Users?$filter=Id eq "+o;return i["default"].Request.get(u,r)},t}Object.defineProperty(t,"__esModule",{value:!0});var u=n(2),i=r(u);t["default"]=o,e.exports=t["default"]}])});
//# sourceMappingURL=SPOCExt.min.js.map